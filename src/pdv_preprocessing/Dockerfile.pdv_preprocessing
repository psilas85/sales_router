# ============================
# üöÄ Dockerfile.pdv_preprocessing
# ============================

# Imagem base compartilhada
FROM psilas85/sales_router-base:latest

# Diret√≥rio de trabalho
WORKDIR /app

# Copia o c√≥digo-fonte da aplica√ß√£o
COPY ./src /app/src

# Copia e instala depend√™ncias globais
COPY ./requirements.txt /app/requirements.txt
RUN pip install --no-cache-dir -r /app/requirements.txt

# Vari√°veis de ambiente padr√£o
ENV PYTHONPATH=/app/src \
    TZ=America/Sao_Paulo \
    ENV=production \
    AUTH_SERVICE_URL=http://authentication_service:8000 \
    LOGURU_LEVEL=INFO

# Exibe informa√ß√µes b√°sicas de debug
RUN python --version && \
    echo "üß© Verificando libs instaladas..." && \
    pip list | grep -E "fastapi|pandas|psycopg2|rq|redis"

# Porta padr√£o da API
EXPOSE 8000

# Comando padr√£o (executa o servidor FastAPI)
CMD ["uvicorn", "src.pdv_preprocessing.api.pdv_preprocessing_api:app", "--host", "0.0.0.0", "--port", "8000"]
